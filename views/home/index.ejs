<div class="top-bar">
    <div class="container clearfix">

    </div>
</div>

<div class="container clearfix">
    <div class="main">
    		<h1 id="header">
    			Food Inventory
    		</h1>

    		<div id="content" ng-controller="FoodController">
    			<table>
    				<thead>
    					<tr class="row">
    						<th>Name</th>
    						<th>Type</th>
    						<th>Expiration</th>
    						<th>Quantity</th>
    						<th>Percent Remaining</th>
    					</tr>
    				</thead>
    				<tbody>
    					<tr class="row" ng-repeat="f in food">
    						<td>{{f.name}}</td>
    						<td>{{f.type}}</td>
    						<td>{{f.expiration}}</td>
    						<td>{{f.quantity}}</td>
    						<td class="progress">
    							<div class="bar" style="width: {{f.percentRemaining}}%"</td>
    					</tr>
    				</tbody>
    			</table>

    			<button ng-click="toggleForm()" ng-hide="isFormActive">Add One</button>
    			<button ng-click="toggleForm()" ng-show="isFormActive">Hide Form</button>
    			<form ng-show="isFormActive">
    				<hr />
    				<label for="name">Name:</label>
    				<input name="name" ng-model="editableFood.name" />
    				<br />

    				<label for="type">Type:</label>
    				<input name="type" ng-model="editableFood.type" />
    				<br />

    				<label for="expiration">Expiration</label>
    				<input name="expiration" ng-model="editableFood.expiration" />
    				<br />

    				<label for="quantity">Quantity</label>
    				<input name="quantity" ng-model="editableFood.quantity" />
    				<br />

    				<label for="percentRemaining">Percent Remaining</label>
    				<input name="percentRemaining" ng-model="editableFood.percentRemaining" />
    				<br />

    					<div class="span4 text-right">
    						<div class="row">
    							<button ng-click="toggleForm()">Cancel</button>
    							<button ng-click="addFood()">Add</button>
    						</div>
    					</div>
    				</form>
    		</div>

    		<div id="footer">
    			<a target="_blank" href="http://sailsjs.com" class="copyright">Built with Sails.js</a>
    		</div>

   	<script type='text/javascript'>
   		var foodApp = angular.module('foodApp', ['ngResource']);

   		foodApp.factory('Food', ['$resource', function($resource){return $resource('/food/:id', {id: '@id'});
   			}]);

   		function FoodController($scope, Food) {
   			$scope.food = Food.query();

   			$scope.isFormActive = false;

   			$scope.toggleForm = function(){
   				if ($scope.isFormActive){
   					$scope.isFormActive = false;
   					return;
   				}

   				$scope.isFormActive = true;
   				$scope.editableFood = new Food();
   			};

   			$scope.addFood = function(){
   				$scope.editableFood.$save();
   				$scope.food.push($scope.editableFood);
   				$scope.toggleForm();
   			};
   		};
   	</script>


    </div>
    <div class="side-bar">

    </div>
</div>
